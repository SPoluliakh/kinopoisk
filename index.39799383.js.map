{"mappings":"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","sources":["src/index.js","src/js/functions/search-film.js","node_modules/debounce/index.js"],"sourcesContent":["import { darkmode } from './js/functions/darkmode';\nimport './js/functions/pagination';\n\nimport { moviesListMarkupFirstRender } from './js/functions/render-home-page';\nimport { setGenreOptions } from './js/functions/local-storage';\nimport { openMovieInfo } from './js/functions/open-movie-info';\nimport { listRef, backdropRef } from './js/refs/refs';\nimport './js/functions/search-film';\nimport './js/functions/login';\nimport './js/functions/pagination';\nimport './js/functions/developers-modal';\nimport { btnUp } from './js/components/to-top-button';\nimport { darkmode } from './js/functions/darkmode';\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  setGenreOptions();\n  moviesListMarkupFirstRender();\n  listRef.addEventListener('click', evt => {\n    backdropRef.style.display = 'block';\n    openMovieInfo(evt);\n  });\n  btnUp.addEventListener();\n  darkmode();\n});\n","import Pagination from 'tui-pagination';\n\nimport {\n  searchFormRef,\n  listRef,\n  paginationContainer,\n  errorRef,\n  searchListRef,\n  searchInputRef,\n  cleanButtonRef,\n  backdropRef,\n} from '../refs/refs';\nimport { getBySearchName } from '../api/get-api';\nimport { makeMovieList } from '../components/movie-cards';\nimport { getGenreOptions } from './local-storage';\nimport {\n  pagination,\n  updateMoviesList,\n  makePaginationOptions,\n} from '../functions/pagination';\nimport { startSpinner, stopSpinner } from '../components/spinner';\nimport { debounce } from 'debounce';\nimport { openMovieInfo } from './open-movie-info';\n\nlet searchValue;\n\nsearchFormRef.addEventListener('submit', onFormSubmit);\nsearchInputRef.addEventListener('input', debounce(inputSearch, 500));\nsearchListRef.addEventListener('click', event => {backdropRef.style.display = \"block\"; openMovieInfo(event)});\ncleanButtonRef.addEventListener('click', cleanSearch);\n\nasync function onFormSubmit(event) {\n  event.preventDefault();\n  searchValue = event.currentTarget.searchQuery.value.trim();\n  startSpinner();\n  if (!searchValue) {\n    stopSpinner();\n    return;\n  }\n\n  const movies = await getBySearchName(searchValue);\n  const { results, total_results } = movies.data;\n  const paginationOptions = makePaginationOptions(total_results);\n\n  if (results.length === 0) {\n    errorRef.classList.add('show-error');\n    setTimeout(() => {\n      errorRef.classList.remove('show-error');\n    }, 3000);\n    stopSpinner();\n    return;\n  }\n\n  stopSpinner();\n  errorRef.classList.remove('show-error');\n  const genres = getGenreOptions() ?? [];\n  const movieList = makeMovieList(results, genres);\n  listRef.innerHTML = movieList;\n  searchListRef.innerHTML = '';\n\n  // Pagination part\n\n  try {\n    pagination.reset();\n    pagination.off('afterMove', updateMoviesList);\n    const paginationByName = new Pagination(\n      paginationContainer,\n      paginationOptions\n    );\n    paginationByName.off('afterMove', updateMoviesListByName);\n    paginationByName.on('afterMove', updateMoviesListByName);\n  } catch (error) {\n    console.log(error);\n  }\n}\n\nasync function updateMoviesListByName(event) {\n  const currentPage = event.page;\n  localStorage.setItem('page', currentPage);\n  const movies = await getBySearchName(searchValue, currentPage);\n  const { results } = movies.data;\n  console.log(movies.data);\n  const genres = getGenreOptions() ?? [];\n  const movieList = makeMovieList(results, genres);\n  listRef.innerHTML = movieList;\n  document.documentElement.scrollTo({ top: 0, behavior: 'smooth' });\n}\n\nasync function inputSearch(event) {\n  searchListRef.classList.remove('visually-hidden');\n  searchListRef.innerHTML = '';\n  backdropRef.style.display = 'block';\n  searchValue = event.target.value.trim();\n\n  if (!searchValue) {\n    searchListRef.classList.add('visually-hidden');\n    return;\n  }\n\n  startSpinner();\n  const movies = await getBySearchName(searchValue);\n  stopSpinner();\n  const { results } = movies.data;\n  if (results.length === 0) {\n    errorRef.classList.add('show-error');\n    setTimeout(() => {\n      errorRef.classList.remove('show-error');\n    }, 3000);\n    return;\n  }\n  searchListRef.insertAdjacentHTML(\n    'beforeend',\n    makeSearchList(results.slice(0, 5))\n  );\n}\n\nfunction makeSearchList(list) {\n  let markup = '';\n  list.forEach(\n    ({ title, id, release_date }) =>\n      (markup += `<li class=\"search-list-item\" data-id=${id}>${title} <span class=\"release-date\">(${\n        release_date ? release_date.slice(0, 4) : 'no info'\n      })</span></li>`)\n  );\n  return markup;\n}\n\nfunction cleanSearch() {\n  searchInputRef.value = '';\n  searchListRef.innerHTML = '';\n  searchInputRef.focus();\n}\n","/**\n * Returns a function, that, as long as it continues to be invoked, will not\n * be triggered. The function will be called after it stops being called for\n * N milliseconds. If `immediate` is passed, trigger the function on the\n * leading edge, instead of the trailing. The function also has a property 'clear' \n * that is a function which will clear the timer to prevent previously scheduled executions. \n *\n * @source underscore.js\n * @see http://unscriptable.com/2009/03/20/debouncing-javascript-methods/\n * @param {Function} function to wrap\n * @param {Number} timeout in ms (`100`)\n * @param {Boolean} whether to execute at the beginning (`false`)\n * @api public\n */\nfunction debounce(func, wait, immediate){\n  var timeout, args, context, timestamp, result;\n  if (null == wait) wait = 100;\n\n  function later() {\n    var last = Date.now() - timestamp;\n\n    if (last < wait && last >= 0) {\n      timeout = setTimeout(later, wait - last);\n    } else {\n      timeout = null;\n      if (!immediate) {\n        result = func.apply(context, args);\n        context = args = null;\n      }\n    }\n  };\n\n  var debounced = function(){\n    context = this;\n    args = arguments;\n    timestamp = Date.now();\n    var callNow = immediate && !timeout;\n    if (!timeout) timeout = setTimeout(later, wait);\n    if (callNow) {\n      result = func.apply(context, args);\n      context = args = null;\n    }\n\n    return result;\n  };\n\n  debounced.clear = function() {\n    if (timeout) {\n      clearTimeout(timeout);\n      timeout = null;\n    }\n  };\n  \n  debounced.flush = function() {\n    if (timeout) {\n      result = func.apply(context, args);\n      context = args = null;\n      \n      clearTimeout(timeout);\n      timeout = null;\n    }\n  };\n\n  return debounced;\n};\n\n// Adds compatibility for ES modules\ndebounce.debounce = debounce;\n\nmodule.exports = debounce;\n"],"names":["$AFyA5","parcelRequire","$fb9GJ","$815ad92c071f8c63$var$debounce","func","wait","immediate","timeout","args","context","timestamp","result","later","last","Date","now","setTimeout","apply","debounced","this","arguments","callNow","clear","clearTimeout","flush","debounce","$815ad92c071f8c63$exports","$5f3c226c1d092df4$var$searchValue","async","$5f3c226c1d092df4$var$updateMoviesListByName","event","currentPage","page","localStorage","setItem","movies","$6TDp9","getBySearchName","results","data","console","log","genres","$1CpbH","getGenreOptions","movieList","$bnlKQ","makeMovieList","$3ILHO","listRef","innerHTML","document","documentElement","scrollTo","top","behavior","searchFormRef","addEventListener","preventDefault","currentTarget","searchQuery","value","trim","$bHKmf","startSpinner","stopSpinner","total_results","paginationOptions","$kKZR4","makePaginationOptions","length","errorRef","classList","add","remove","searchListRef","pagination","reset","off","updateMoviesList","paginationByName","$parcel$interopDefault","paginationContainer","on","error","searchInputRef","backdropRef","style","display","target","insertAdjacentHTML","list","markup","forEach","title","id","release_date","slice","$5f3c226c1d092df4$var$makeSearchList","$hc5U3","openMovieInfo","cleanButtonRef","focus","setGenreOptions","$5Y3BN","moviesListMarkupFirstRender","evt","$aOITw","btnUp","darkmode"],"version":3,"file":"index.39799383.js.map"}